import{i as P,u as S,f as C,c as h,j as e,L as E,a}from"./index-CxMBQFuI.js";import{r as c,A as z,v as G,S as L,t as q,z as t}from"./ui-libs-DeieS4Kk.js";import{u as p}from"./useMutation-CWwu1FJs.js";import"./vendor-qkC6yhPU.js";const I=()=>{const{id:r}=P(),b=S(),d=C(),[o,f]=c.useState(""),[u,i]=c.useState([]),[m,x]=c.useState(!1),{data:j}=h({queryKey:["adminCarouselGroups"],queryFn:()=>a.getCarouselGroups()}),y=j?.find(s=>s.id.toString()===r),{data:l,isLoading:v}=h({queryKey:["customCollectionProducts",r],queryFn:()=>a.getCustomCollectionProducts(r)}),g=p({mutationFn:s=>a.addCustomGroupItem(r,s),onSuccess:()=>{d.invalidateQueries(["customCollectionProducts",r]),t.success("Producto agregado")},onError:s=>{console.error(s),t.error("Error al agregar producto")}}),N=p({mutationFn:s=>a.removeCustomGroupItem(r,s),onSuccess:()=>{d.invalidateQueries(["customCollectionProducts",r]),t.success("Producto eliminado del grupo")},onError:s=>{console.error(s),t.error("Error al eliminar producto")}}),w=async s=>{if(s.preventDefault(),!!o.trim()){x(!0);try{const n=await a.fetchProducts(1,o);n.products&&n.products.length>0?i(n.products):(t.error("No se encontraron productos"),i([]))}catch{t.error("Error al buscar producto"),i([])}finally{x(!1)}}};return v?e.jsx(E,{}):e.jsxs("div",{className:"container mx-auto p-4 max-w-6xl",children:[e.jsxs("button",{onClick:()=>b("/admin/launch-groups"),className:"flex items-center text-gray-500 hover:text-gray-700 mb-6",children:[e.jsx(z,{size:18,className:"mr-2"}),"Volver a Grupos de Lanzamiento"]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("div",{children:e.jsxs("h2",{className:"text-xl font-bold",children:["Productos en: ",y?.name||"Cargando..."]})}),e.jsxs("span",{className:"text-gray-500 text-sm",children:[l?.length||0," productos"]})]}),e.jsxs("div",{className:"space-y-3",children:[l?.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border border-gray-200 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-md flex items-center justify-center overflow-hidden",children:s.imageUrl?e.jsx("img",{src:s.imageUrl,alt:s.name,className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-xs text-gray-400",children:"Sin img"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 line-clamp-1",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.code," - ",s.formattedPrice]})]})]}),e.jsx("button",{onClick:()=>N.mutate(s.id),className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:"Quitar del grupo",children:e.jsx(G,{size:18})})]},s.id)),(!l||l.length===0)&&e.jsx("div",{className:"p-8 text-center text-gray-400 border-2 border-dashed border-gray-200 rounded-lg",children:"Este grupo está vacío. Agrega productos usando el buscador."})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm h-fit",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"Agregar Producto"}),e.jsx("form",{onSubmit:w,className:"mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Buscar por nombre o código...",className:"w-full border border-gray-300 rounded-lg pl-3 pr-10 py-2 focus:ring-2 focus:ring-espint-blue focus:border-transparent outline-none",value:o,onChange:s=>f(s.target.value)}),e.jsx("button",{type:"submit",className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-espint-blue",disabled:m,children:e.jsx(L,{size:20})})]})}),e.jsxs("div",{className:"space-y-3 max-h-[500px] overflow-y-auto pr-1",children:[u.map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex gap-3 mb-2",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-md overflow-hidden flex-shrink-0",children:s.imageUrl?e.jsx("img",{src:s.imageUrl,alt:s.name,className:"w-full h-full object-contain mix-blend-multiply"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-xs text-center p-1",children:"Sin Imagen"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-semibold text-sm line-clamp-2 leading-tight mb-1",title:s.name,children:s.name}),e.jsx("p",{className:"text-xs text-blue-600 font-bold",children:s.code})]})]}),e.jsxs("button",{onClick:()=>g.mutate(s.id),className:"w-full bg-white border border-espint-blue text-espint-blue py-1.5 rounded-md text-sm font-medium hover:bg-espint-blue hover:text-white transition-colors flex items-center justify-center gap-2",disabled:g.isLoading,children:[e.jsx(q,{size:16}),"Agregar"]})]},s.id)),u.length===0&&!m&&o&&e.jsx("p",{className:"text-center text-gray-500 text-sm py-4",children:"No hay resultados"})]})]})]})]})};export{I as default};
