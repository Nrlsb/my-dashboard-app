import{h as S,u as P,f as C,c as h,j as e,L as E,a}from"./index-CNDH1LwZ.js";import{r as d,A as L,u as z,S as A,s as q,z as o}from"./ui-libs-xkhqbQ7p.js";import{u as p}from"./useMutation-ByT12LMu.js";import"./vendor-qkC6yhPU.js";const F=()=>{const{id:r}=S(),f=P(),u=C(),[l,m]=d.useState(""),[t,i]=d.useState(null),[b,g]=d.useState(!1),{data:j}=h({queryKey:["adminCarouselGroups"],queryFn:()=>a.get("/admin/carousel-groups")}),y=j?.find(s=>s.id.toString()===r),{data:n,isLoading:v}=h({queryKey:["customCollectionProducts",r],queryFn:()=>a.get(`/products/collection/${r}`)}),c=p({mutationFn:s=>a.post(`/admin/custom-collection/${r}/items`,{productId:s}),onSuccess:()=>{u.invalidateQueries(["customCollectionProducts",r]),o.success("Producto agregado"),i(null),m("")},onError:s=>{console.error(s),o.error("Error al agregar producto")}}),N=p({mutationFn:s=>a.delete(`/admin/custom-collection/${r}/items/${s}`),onSuccess:()=>{u.invalidateQueries(["customCollectionProducts",r]),o.success("Producto eliminado del grupo")},onError:s=>{console.error(s),o.error("Error al eliminar producto")}}),w=async s=>{if(s.preventDefault(),!!l.trim()){g(!0);try{const x=await a.get(`/products/code/${l.trim()}`);i(x)}catch{o.error("Producto no encontrado"),i(null)}finally{g(!1)}}};return v?e.jsx(E,{}):e.jsxs("div",{className:"container mx-auto p-4 max-w-6xl",children:[e.jsxs("button",{onClick:()=>f("/admin/launch-groups"),className:"flex items-center text-gray-500 hover:text-gray-700 mb-6",children:[e.jsx(L,{size:18,className:"mr-2"}),"Volver a Grupos de Lanzamiento"]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("div",{children:e.jsxs("h2",{className:"text-xl font-bold",children:["Productos en: ",y?.name||"Cargando..."]})}),e.jsxs("span",{className:"text-gray-500 text-sm",children:[n?.length||0," productos"]})]}),e.jsxs("div",{className:"space-y-3",children:[n?.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border border-gray-200 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-md flex items-center justify-center overflow-hidden",children:s.imageUrl?e.jsx("img",{src:s.imageUrl,alt:s.name,className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-xs text-gray-400",children:"Sin img"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 line-clamp-1",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.code," - ",s.formattedPrice]})]})]}),e.jsx("button",{onClick:()=>N.mutate(s.id),className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:"Quitar del grupo",children:e.jsx(z,{size:18})})]},s.id)),(!n||n.length===0)&&e.jsx("div",{className:"p-8 text-center text-gray-400 border-2 border-dashed border-gray-200 rounded-lg",children:"Este grupo está vacío. Agrega productos usando el buscador."})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm h-fit",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"Agregar Producto"}),e.jsx("form",{onSubmit:w,className:"mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Buscar Código Exacto...",className:"w-full border border-gray-300 rounded-lg pl-3 pr-10 py-2 focus:ring-2 focus:ring-espint-blue focus:border-transparent outline-none",value:l,onChange:s=>m(s.target.value)}),e.jsx("button",{type:"submit",className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-espint-blue",disabled:b,children:e.jsx(A,{size:20})})]})}),t&&e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 animate-fadeIn",children:[e.jsx("div",{className:"w-full h-32 bg-gray-100 rounded-md overflow-hidden mb-3",children:t.imageUrl?e.jsx("img",{src:t.imageUrl,alt:t.name,className:"w-full h-full object-contain mix-blend-multiply"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-sm",children:"Sin Imagen"})}),e.jsx("h4",{className:"font-semibold text-sm line-clamp-2 mb-1",children:t.name}),e.jsx("p",{className:"text-xs text-gray-500 mb-2",children:t.code}),e.jsxs("button",{onClick:()=>c.mutate(t.id),className:"w-full bg-espint-blue text-white py-2 rounded-lg text-sm font-medium hover:bg-espint-blue-dark transition-colors flex items-center justify-center gap-2",disabled:c.isLoading,children:[e.jsx(q,{size:16}),c.isLoading?"Agregando...":"Agregar al Grupo"]})]})]})]})]})};export{F as default};
