import{b as p,j as e,L as g,a as x}from"./index-DPxrioS2.js";import{r as a,a6 as f,C as u,M as y,P as j}from"./ui-libs-BPe1M2wt.js";import"./vendor-qkC6yhPU.js";const w=()=>{const{user:l}=p(),[o,h]=a.useState([]),[c,d]=a.useState(!0),[r,n]=a.useState(null),[i,b]=a.useState(new Set);a.useEffect(()=>{(async()=>{if(console.log("[VendedorClientsPage] authUser:",l),!l){n("Acceso denegado. Se requiere autenticación."),d(!1);return}try{d(!0);let t;if(l.is_admin)t=await x.getAllClients(),console.log("[VendedorClientsPage] Fetched all clients for admin:",t);else if(l.role==="vendedor")t=await x.getVendedorClients(),console.log("[VendedorClientsPage] Fetched seller-specific clients:",t);else{n("Acceso denegado. No tiene permisos para ver esta sección."),d(!1);return}h(t)}catch(t){console.error("Error al obtener clientes:",t),n("Error al cargar los clientes. Intente de nuevo más tarde."),console.log("[VendedorClientsPage] Error fetching clients:",t)}finally{d(!1)}})()},[l]);const m=s=>{const t=new Set(i);t.has(s)?t.delete(s):t.add(s),b(t)};return e.jsxs("div",{className:"p-4 md:p-8 bg-gray-100 min-h-screen",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-800 mb-6 text-center",children:l&&l.is_admin?"Todos los Clientes":"Mis Clientes"}),c&&e.jsx(g,{text:"Cargando clientes..."}),r&&e.jsx("p",{className:"text-red-500 text-center text-lg mt-4",children:r}),!c&&!r&&(o.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full mt-6 border-collapse md:shadow-md md:bg-white md:rounded-lg overflow-hidden block md:table",children:[e.jsx("thead",{className:"hidden md:table-header-group bg-white text-[var(--color-espint-blue)] border-b-2 border-[var(--color-espint-blue)]",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-base",children:"Nombre Completo"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-base",children:"Email"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-base",children:"Código"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-base",children:"Cuit/Cuil"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-base",children:"Teléfono"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-base",children:"Dirección"})]})}),e.jsx("tbody",{className:"block md:table-row-group",children:o.map(s=>{const t=i.has(s.id);return e.jsxs("tr",{className:"block md:table-row mb-4 md:mb-0 bg-white md:bg-transparent shadow-md md:shadow-none rounded-lg md:rounded-none border border-gray-200 md:border-b md:border-gray-200 transition-colors duration-200 ease-in-out hover:bg-gray-50 last:border-b-0",children:[e.jsx("td",{className:"px-4 py-3 md:py-3 text-sm text-gray-700 block md:table-cell border-b md:border-none border-gray-100",children:e.jsxs("div",{className:"flex justify-between items-center md:block",children:[e.jsx("span",{className:"font-bold text-lg md:text-sm md:font-normal text-[var(--color-espint-blue)] md:text-gray-700",children:s.full_name}),e.jsx("button",{onClick:()=>m(s.id),className:"md:hidden p-1 text-gray-500 hover:text-blue-600 focus:outline-none",children:t?e.jsx(f,{size:24}):e.jsx(u,{size:24})})]})}),e.jsx("td",{className:"px-4 py-2 md:py-3 text-sm text-gray-700 block md:table-cell",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"md:hidden text-gray-400",children:e.jsx(y,{size:16})}),e.jsx("span",{children:s.email})]})}),e.jsxs("td",{className:`px-4 py-2 md:py-3 text-sm text-gray-700 ${t?"block":"hidden"} md:table-cell`,children:[e.jsx("span",{className:"font-bold text-gray-500 md:hidden block",children:"Código: "}),s.a1_cod]}),e.jsxs("td",{className:`px-4 py-2 md:py-3 text-sm text-gray-700 ${t?"block":"hidden"} md:table-cell`,children:[e.jsx("span",{className:"font-bold text-gray-500 md:hidden block",children:"Cuit/Cuil: "}),s.a1_cgc]}),e.jsx("td",{className:"px-4 py-2 md:py-3 text-sm text-gray-700 block md:table-cell",children:e.jsxs("div",{className:"flex items-center gap-2 md:block",children:[e.jsx("span",{className:"md:hidden text-green-600",children:e.jsx(j,{size:16})}),e.jsx("a",{href:`tel:${s.a1_tel}`,className:"text-blue-600 hover:underline md:text-gray-700 md:hover:no-underline md:pointer-events-none",children:s.a1_tel})]})}),e.jsxs("td",{className:`px-4 py-2 md:py-3 text-sm text-gray-700 ${t?"block":"hidden"} md:table-cell`,children:[e.jsx("span",{className:"font-bold text-gray-500 md:hidden block",children:"Dirección: "}),s.a1_endereco]}),!t&&e.jsx("td",{className:"px-4 py-2 block md:hidden text-center border-t border-gray-100 mt-2",children:e.jsx("button",{onClick:()=>m(s.id),className:"text-blue-500 text-sm font-semibold flex items-center justify-center w-full",children:"Ver detalles +"})})]},s.id)})})]})}):e.jsxs("p",{className:"text-center text-gray-500 mt-10",children:["No hay clientes ",l&&l.is_admin?"en el sistema.":"asignados a este vendedor."]}))]})};export{w as default};
