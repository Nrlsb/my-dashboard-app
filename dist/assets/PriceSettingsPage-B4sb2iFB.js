import{j as e,L as v,a as u}from"./index-BpIgjRdq.js";import{r as o,a6 as m}from"./ui-libs-DeieS4Kk.js";import"./vendor-qkC6yhPU.js";const A=()=>{const[l,g]=o.useState([]),[c,n]=o.useState([]),[h,p]=o.useState(!0),[i,x]=o.useState(!1);o.useEffect(()=>{(async()=>{try{p(!0);const a=await u.getProductGroupsForAdmin({params:{onlyWithModifications:!0}}),r=new Map;a.forEach(t=>{t.product_group&&!r.has(t.product_group)&&r.set(t.product_group,{code:t.product_group,name:t.brand||"Sin descripción"})});const N=Array.from(r.values()).sort((t,S)=>t.code.localeCompare(S.code));g(N);const d=await u.getGlobalSetting("price_modified_allowed_groups");if(d&&d.value)try{const t=JSON.parse(d.value);Array.isArray(t)&&n(t)}catch(t){console.error("Failed to parse setting",t)}}catch(a){console.error(a),m.error("Error al cargar datos")}finally{p(!1)}})()},[]);const f=s=>{n(a=>a.includes(s)?a.filter(r=>r!==s):[...a,s])},b=()=>{n(l.map(s=>s.code))},y=()=>{n([])},j=async()=>{try{x(!0);const s=JSON.stringify(c);await u.updateGlobalSetting("price_modified_allowed_groups",s),m.success("Configuración guardada correctamente")}catch(s){console.error(s),m.error("Error al guardar configuración")}finally{x(!1)}};return h?e.jsx(v,{text:"Cargando grupos..."}):e.jsxs("div",{className:"p-4 md:p-8 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Alertas de Precio Modificado"}),e.jsxs("p",{className:"text-gray-600 mt-2",children:['Selecciona qué grupos de productos mostrarán la etiqueta "Precio modificado" cuando cambien de precio.',e.jsx("br",{}),e.jsx("span",{className:"text-sm font-semibold text-amber-600",children:"Nota: Si no seleccionas ninguno, se mostrará para TODOS los grupos (comportamiento por defecto)."})]})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold",children:["Grupos de Productos (",l.length,")"]}),e.jsxs("div",{className:"space-x-2",children:[e.jsx("button",{onClick:b,className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:"Seleccionar Todos"}),e.jsx("span",{className:"text-gray-300",children:"|"}),e.jsx("button",{onClick:y,className:"text-sm text-gray-600 hover:text-gray-800 font-medium",children:"Limpiar Selección"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 max-h-[60vh] overflow-y-auto mb-6 border p-4 rounded bg-gray-50",children:l.map(s=>e.jsxs("label",{className:"flex items-center space-x-3 p-2 hover:bg-white rounded cursor-pointer transition-colors",children:[e.jsx("input",{type:"checkbox",className:"h-5 w-5 text-blue-600 rounded border-gray-300 focus:ring-blue-500",checked:c.includes(s.code),onChange:()=>f(s.code)}),e.jsxs("span",{className:"text-gray-700 text-sm font-medium truncat",title:`${s.code} - ${s.name}`,children:[e.jsx("span",{className:"font-bold text-gray-500 mr-2",children:s.code}),s.name]})]},s.code))}),e.jsxs("div",{className:"flex justify-between items-center border-t pt-4",children:[e.jsx("div",{className:"text-sm text-gray-500",children:c.length===0?"Ningún grupo seleccionado (Se mostrará alerta en TODOS los productos)":`${c.length} grupos seleccionados`}),e.jsx("button",{onClick:j,disabled:i,className:`px-6 py-2 rounded-md text-white font-medium transition-colors ${i?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:i?"Guardando...":"Guardar Configuración"})]})]})]})};export{A as default};
