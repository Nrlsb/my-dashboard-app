import{a as v,j as e,L as A}from"./index-BgaD64LX.js";import{r as t,s as _,S as C,g as M,V as T}from"./ui-libs-BPe1M2wt.js";import"./vendor-qkC6yhPU.js";const F=()=>{const[l,k]=t.useState([]),[S,x]=t.useState(!0),[u,m]=t.useState(null),[g,a]=t.useState(null),[h,o]=t.useState(null),[n,P]=t.useState(""),[E,p]=t.useState(!1),[i,f]=t.useState(null),[r,b]=t.useState(""),[y,j]=t.useState(""),w=t.useCallback(async()=>{try{x(!0),m(null);const s=await v.getAllClients();k(s)}catch(s){m(s.message||"Error al cargar los clientes.")}finally{x(!1)}},[]);t.useEffect(()=>{w()},[w]);const L=s=>{P(s.target.value)},N=t.useMemo(()=>{if(!n)return l;const s=n.toLowerCase();return l.filter(d=>(d.full_name?.toLowerCase()||"").includes(s)||(d.email?.toLowerCase()||"").includes(s)||(d.a1_cod?.toLowerCase()||"").includes(s))},[l,n]),R=s=>{f(s),b(""),j(""),a(null),o(null),p(!0)},c=()=>{p(!1),f(null)},U=async()=>{if(!r){a("La contraseña es requerida.");return}if(r.length<6){a("La contraseña debe tener al menos 6 caracteres.");return}if(r!==y){a("Las contraseñas no coinciden.");return}try{a(null),await v.resetUserPassword(i.id,r),o(`Contraseña restablecida correctamente para ${i.full_name}.`),c(),setTimeout(()=>o(null),3e3)}catch(s){a(s.message||"Error al restablecer la contraseña.")}};return S?e.jsx(A,{text:"Cargando usuarios..."}):u?e.jsx("div",{className:"p-8 text-center",children:e.jsxs("div",{className:"text-red-600 bg-red-100 p-4 rounded-lg inline-block",children:["Error: ",u]})}):e.jsxs("div",{className:"p-4 sm:p-8 max-w-7xl mx-auto min-h-screen bg-gray-50",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-6 text-center",children:"Gestión de Usuarios"}),h&&e.jsxs("div",{className:"mb-6 p-4 bg-green-100 border-l-4 border-green-500 text-green-700 flex items-center justify-center rounded shadow-sm animate-fade-in-down",children:[e.jsx(_,{className:"w-5 h-5 mr-2"}),e.jsx("span",{children:h})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden border border-gray-100",children:[e.jsx("div",{className:"p-6 border-b border-gray-100 flex flex-col sm:flex-row justify-between items-center gap-4 bg-gray-50/50",children:e.jsxs("div",{className:"relative w-full sm:w-96",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(C,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"Buscar por nombre, email o código...",className:"pl-10 pr-4 py-2.5 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all shadow-sm",value:n,onChange:L})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Usuario"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Código"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:N.length>0?N.map(s=>e.jsxs("tr",{className:"hover:bg-blue-50/30 transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center text-blue-700 font-bold shadow-sm",children:s.full_name?.charAt(0).toUpperCase()||"U"})}),e.jsx("div",{className:"ml-4",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.full_name})})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800",children:s.a1_cod||"N/A"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.email}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("button",{onClick:()=>R(s),className:"text-white bg-indigo-600 hover:bg-indigo-700 focus:ring-4 focus:ring-indigo-300 font-medium rounded-lg text-xs px-4 py-2 transition-all shadow-sm focus:outline-none flex items-center justify-center ml-auto gap-2",children:[e.jsx(M,{className:"w-3.5 h-3.5"}),"Reset Password"]})})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"px-6 py-10 text-center text-gray-500",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(C,{className:"h-10 w-10 text-gray-300 mb-3"}),e.jsx("p",{className:"text-lg font-medium",children:"No se encontraron usuarios"}),e.jsx("p",{className:"text-sm",children:"Intenta con otros términos de búsqueda."})]})})})})]})})]}),E&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center overflow-x-hidden overflow-y-auto outline-none focus:outline-none bg-black/50 backdrop-blur-sm transition-opacity",children:e.jsx("div",{className:"relative w-full max-w-md mx-auto my-6",children:e.jsxs("div",{className:"relative flex flex-col w-full bg-white border-0 rounded-xl shadow-2xl outline-none focus:outline-none animate-bounce-in",children:[e.jsxs("div",{className:"flex items-start justify-between p-5 border-b border-solid border-gray-200 rounded-t-xl bg-gray-50",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Restablecer Contraseña"}),e.jsx("button",{className:"p-1 ml-auto bg-transparent border-0 text-gray-400 hover:text-gray-900 float-right text-3xl leading-none font-semibold outline-none focus:outline-none transition-colors",onClick:c,children:e.jsx("span",{className:"bg-transparent h-6 w-6 text-2xl block outline-none focus:outline-none",children:"×"})})]}),e.jsxs("div",{className:"relative p-6 flex-auto",children:[e.jsxs("p",{className:"my-2 text-gray-600 text-sm leading-relaxed mb-6",children:["Estás restableciendo la contraseña para el usuario:",e.jsx("br",{}),e.jsx("strong",{className:"text-gray-900 block mt-1 text-base",children:i?.full_name})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nueva Contraseña"}),e.jsx("input",{type:"password",id:"newPassword",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all outline-none",value:r,onChange:s=>b(s.target.value),placeholder:"Ingresa la nueva contraseña"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirmar Contraseña"}),e.jsx("input",{type:"password",id:"confirmPassword",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all outline-none",value:y,onChange:s=>j(s.target.value),placeholder:"Repite la nueva contraseña"})]}),g&&e.jsxs("div",{className:"text-red-600 text-sm bg-red-50 p-2 rounded flex items-start gap-2",children:[e.jsx(T,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:g})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end p-6 border-t border-solid border-gray-200 rounded-b-xl bg-gray-50",children:[e.jsx("button",{className:"text-gray-500 background-transparent font-bold uppercase px-6 py-2 text-sm outline-none focus:outline-none mr-2 mb-1 ease-linear transition-all duration-150 hover:bg-gray-200 rounded-lg",type:"button",onClick:c,children:"Cancelar"}),e.jsx("button",{className:"bg-indigo-600 text-white active:bg-indigo-700 font-bold uppercase text-sm px-6 py-3 rounded-lg shadow hover:shadow-lg outline-none focus:outline-none mr-1 mb-1 ease-linear transition-all duration-150 hover:bg-indigo-700",type:"button",onClick:U,children:"Guardar Cambios"})]})]})})})]})};export{F as default};
