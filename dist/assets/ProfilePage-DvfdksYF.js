import{c as N,r as m,u as E,a as P,g as k,j as e,U as g,M as L,P as D,b as j}from"./index-dnkAJIqY.js";import{u as O}from"./useQuery-CNBHnAnr.js";import{u as S}from"./useMutation-2AA5oov8.js";import{A as p}from"./arrow-left-HgVwNh4G.js";import{T as U}from"./triangle-alert-Bpi5QR_u.js";import{C as I}from"./circle-check-big-DHVEc-MS.js";import{L as z}from"./loader-circle-CBcQI06a.js";import{S as B}from"./save-mBnYdOHI.js";import"./useBaseQuery-Cxm0kh_1.js";const G=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],R=N("building",G);const T=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],q=N("house",T),d=({icon:s,label:o,id:t,...n})=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:t,className:"block text-sm font-medium text-gray-700 mb-1",children:o}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(s,{className:"w-5 h-5 text-gray-400"})}),e.jsx("input",{id:t,className:"w-full pl-10 p-2.5 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100",...n})]})]}),J=()=>e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"bg-gray-200 h-12 rounded-lg"}),e.jsx("div",{className:"bg-gray-200 h-12 rounded-lg"})]}),e.jsx("div",{className:"bg-gray-200 h-12 rounded-lg"}),e.jsx("div",{className:"bg-gray-200 h-12 rounded-lg"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"bg-gray-200 h-12 rounded-lg"}),e.jsx("div",{className:"bg-gray-200 h-12 rounded-lg"})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx("div",{className:"bg-gray-200 h-10 w-28 rounded-lg"})})]}),F=({message:s})=>e.jsxs("div",{className:"flex flex-col items-center justify-center p-10 bg-white rounded-lg shadow-md",children:[e.jsx("p",{className:"text-red-500 font-semibold text-lg",children:"Error al cargar el perfil"}),e.jsx("p",{className:"text-gray-600 mt-2",children:s})]});function ee(){const[s,o]=m.useState({A1_COD:"",A1_LOJA:"",A1_NOME:"",A1_EMAIL:"",A1_NUMBER:"",A1_CGC:"",A1_END:""}),[t,n]=m.useState(""),[u,h]=m.useState(""),x=E(),{user:c}=P(),b=k(),{data:a,isLoading:y,isError:v,error:A,isSuccess:f}=O({queryKey:["userProfile",c?.id],queryFn:()=>j.fetchUserProfile(),enabled:!!c?.id,staleTime:1e3*60*15});m.useEffect(()=>{f&&a&&o({A1_COD:a.A1_COD||"",A1_LOJA:a.A1_LOJA||"",A1_NOME:a.A1_NOME||"",A1_EMAIL:a.A1_EMAIL||"",A1_NUMBER:a.A1_NUMBER||"",A1_CGC:a.A1_CGC||"",A1_END:a.A1_END||""})},[f,a]);const r=S({mutationFn:j.updateUserProfile,onSuccess:i=>{n("¡Perfil actualizado con éxito!"),h(""),b.invalidateQueries({queryKey:["userProfile",c?.id]}),b.invalidateQueries({queryKey:["currentUser"]})},onError:i=>{h(i.message||"Error al guardar los cambios."),n("")}}),l=i=>{const{id:_,value:C}=i.target;o(w=>({...w,[_]:C}))},M=i=>{i.preventDefault(),n(""),h(""),r.mutate(s)};if(y)return e.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[e.jsxs("header",{className:"mb-6 flex items-center",children:[e.jsx("button",{onClick:()=>x("/dashboard"),className:"flex items-center justify-center p-2 mr-4 text-gray-600 bg-white rounded-full shadow-md hover:bg-gray-100 transition-colors","aria-label":"Volver al dashboard",children:e.jsx(p,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Mi Perfil"}),e.jsx("p",{className:"text-gray-600",children:"Actualiza tu información personal y de contacto."})]})]}),e.jsx("div",{className:"bg-white p-8 rounded-lg shadow-md max-w-4xl mx-auto",children:e.jsx(J,{})})]});if(v){const i=c?.id?A.message:"No se ha podido identificar al usuario.";return e.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[e.jsx("header",{className:"mb-6",children:e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Mi Perfil"})}),e.jsx(F,{message:i})]})}return e.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[e.jsxs("header",{className:"mb-6 flex items-center",children:[e.jsx("button",{onClick:()=>x("/dashboard"),className:"flex items-center justify-center p-2 mr-4 text-gray-600 bg-white rounded-full shadow-md hover:bg-gray-100 transition-colors","aria-label":"Volver al dashboard",children:e.jsx(p,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Mi Perfil"}),e.jsx("p",{className:"text-gray-600",children:"Actualiza tu información personal y de contacto."})]})]}),e.jsx("div",{className:"bg-white p-8 rounded-lg shadow-md max-w-4xl mx-auto",children:e.jsxs("form",{onSubmit:M,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(d,{icon:g,label:"Código de Cliente",id:"A1_COD",value:s.A1_COD,onChange:l,disabled:!0}),e.jsx(d,{icon:R,label:"Sucursal (Loja)",id:"A1_LOJA",value:s.A1_LOJA,onChange:l,disabled:!0})]}),e.jsx(d,{icon:g,label:"Nombre / Razón Social",id:"A1_NOME",value:s.A1_NOME,onChange:l,disabled:r.isPending}),e.jsx(d,{icon:g,label:"CUIT",id:"A1_CGC",value:s.A1_CGC,onChange:l,disabled:r.isPending}),e.jsx(d,{icon:q,label:"Dirección",id:"A1_END",value:s.A1_END,onChange:l,disabled:r.isPending}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(d,{icon:L,label:"Email de Contacto",id:"A1_EMAIL",type:"email",value:s.A1_EMAIL,onChange:l,disabled:r.isPending}),e.jsx(d,{icon:D,label:"Teléfono",id:"A1_NUMBER",type:"tel",value:s.A1_NUMBER,onChange:l,disabled:r.isPending})]}),u&&e.jsxs("div",{className:"flex items-center p-3 bg-red-100 text-red-700 rounded-md",children:[e.jsx(U,{className:"w-5 h-5 mr-2 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:u})]}),t&&e.jsxs("div",{className:"flex items-center p-3 bg-green-100 text-green-700 rounded-md",children:[e.jsx(I,{className:"w-5 h-5 mr-2 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:t})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-200",children:e.jsxs("button",{type:"submit",className:"inline-flex items-center justify-center px-6 py-2.5 bg-blue-600 text-white font-medium rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors disabled:opacity-50",disabled:r.isPending,children:[r.isPending?e.jsx(z,{className:"w-5 h-5 mr-2 animate-spin"}):e.jsx(B,{className:"w-5 h-5 mr-2"}),r.isPending?"Guardando...":"Guardar Cambios"]})})]})})]})}export{ee as default};
