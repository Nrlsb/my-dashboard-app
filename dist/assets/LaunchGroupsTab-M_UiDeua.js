import{u as z,f as _,c as E,a as n,j as e,L as P}from"./index-CNukXvt2.js";import{r as x,z as i,s as g,_ as b,u as L,Z as q,ad as F,X as h,w as S}from"./ui-libs-xkhqbQ7p.js";import{u as f}from"./useMutation-DyjYnNWe.js";import"./vendor-qkC6yhPU.js";const K=()=>{const y=z(),u=_(),[j,l]=x.useState(!1),[s,a]=x.useState({name:"",description:"",image_url:"",isUploading:!1,previewUrl:""}),{data:v,isLoading:w}=E({queryKey:["adminCarouselGroups"],queryFn:()=>n.getCarouselGroups()}),c=f({mutationFn:r=>n.createCarouselGroup(r),onSuccess:()=>{u.invalidateQueries({queryKey:["adminCarouselGroups"]}),l(!1),a({name:"",description:"",image_url:"",isUploading:!1,previewUrl:""}),i.success("Grupo creado exitosamente")},onError:r=>{console.error(r),i.error("Error al crear el grupo")}}),N=f({mutationFn:r=>n.deleteCarouselGroup(r),onSuccess:()=>{u.invalidateQueries({queryKey:["adminCarouselGroups"]}),i.success("Grupo eliminado exitosamente")},onError:r=>{console.error(r),i.error("Error al eliminar el grupo")}}),C=r=>{r.preventDefault(),s.name.trim()&&c.mutate({name:s.name,description:s.description,image_url:s.image_url,type:"custom_collection",is_launch_group:!0})},k=r=>{window.confirm("¿Estás seguro de que quieres eliminar este grupo?")&&N.mutate(r)},U=async r=>{const t=r.target.files[0];if(!t)return;const G=URL.createObjectURL(t);a(o=>({...o,isUploading:!0,previewUrl:G}));const p=new FormData;p.append("image",t);try{const o=await n.uploadToDrive(p);a(d=>({...d,image_url:o.imageUrl,isUploading:!1})),i.success("Imagen subida correctamente")}catch(o){console.error(o),i.error("Error al subir imagen"),a(d=>({...d,isUploading:!1}))}};if(w)return e.jsx(P,{});const m=v?.filter(r=>r.is_launch_group===!0)||[];return e.jsxs("div",{className:"pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Grupos de Lanzamiento"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Crea y gestiona colecciones de productos para compartir."})]}),e.jsxs("button",{onClick:()=>l(!0),className:"flex items-center gap-2 bg-espint-blue text-white px-4 py-2 rounded-lg hover:bg-espint-blue-dark transition-colors",children:[e.jsx(g,{size:20}),"Crear Grupo"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[m.map(r=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"h-40 bg-gray-100 relative group overflow-hidden",children:[r.image_url?e.jsx("img",{src:r.image_url,alt:r.name,className:"w-full h-full object-cover transition-transform group-hover:scale-105",referrerPolicy:"no-referrer"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:e.jsx(b,{size:40,className:"opacity-20"})}),e.jsx("button",{onClick:()=>k(r.id),className:"absolute top-2 right-2 p-2 bg-white/80 backdrop-blur-sm text-gray-400 hover:text-red-500 rounded-full shadow-sm transition-colors",title:"Eliminar Grupo",children:e.jsx(L,{size:18})})]}),e.jsxs("div",{className:"p-5",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2 truncate",children:r.name}),r.description&&e.jsx("p",{className:"text-sm text-gray-500 line-clamp-2 mb-4 h-10",children:r.description}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("button",{onClick:()=>y(`/admin/launch-groups/${r.id}`),className:"w-full flex items-center justify-center gap-2 bg-espint-blue/10 text-espint-blue py-2 px-4 rounded-lg hover:bg-espint-blue hover:text-white transition-all font-medium text-sm",children:[e.jsx(q,{size:16}),"Gestionar Productos"]}),e.jsxs("button",{onClick:()=>window.open(`/collection/${r.id}`,"_blank"),className:"w-full flex items-center justify-center gap-2 text-gray-500 py-2 px-4 hover:bg-gray-100 rounded-lg transition-colors text-sm",children:[e.jsx(F,{size:16})," Ver Pública"]})]})]})]},r.id)),m.length===0&&e.jsxs("div",{className:"col-span-full py-12 text-center text-gray-400 border-2 border-dashed border-gray-200 rounded-xl bg-white",children:[e.jsx(g,{size:48,className:"mx-auto mb-4 opacity-10"}),e.jsx("p",{children:"No hay grupos creados. Comienza creando uno nuevo."})]})]}),j&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-gray-50/50",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-800",children:"Crear Nuevo Grupo"}),e.jsx("button",{onClick:()=>l(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(h,{size:20})})]}),e.jsxs("form",{onSubmit:C,className:"p-6",children:[e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1",children:"Nombre del Grupo *"}),e.jsx("input",{type:"text",required:!0,value:s.name,onChange:r=>a(t=>({...t,name:r.target.value})),className:"w-full border border-gray-200 rounded-lg px-4 py-2 focus:ring-2 focus:ring-espint-blue focus:border-transparent outline-none transition-all",placeholder:"Ej. Colección Verano 2026",autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1",children:"Descripción"}),e.jsx("textarea",{value:s.description,onChange:r=>a(t=>({...t,description:r.target.value})),className:"w-full border border-gray-200 rounded-lg px-4 py-2 focus:ring-2 focus:ring-espint-blue focus:border-transparent outline-none transition-all resize-none",placeholder:"Breve descripción del grupo...",rows:"2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"Imagen de Portada"}),s.previewUrl||s.image_url?e.jsxs("div",{className:"mb-3 relative h-32 rounded-lg bg-gray-50 border border-gray-100 overflow-hidden flex items-center justify-center",children:[e.jsx("img",{src:s.previewUrl||s.image_url,alt:"Preview",className:"max-w-full max-h-full object-contain",referrerPolicy:"no-referrer"}),e.jsx("button",{type:"button",onClick:()=>a(r=>({...r,image_url:"",previewUrl:""})),className:"absolute top-1.5 right-1.5 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 shadow-sm transition-colors",children:e.jsx(h,{size:14})})]}):e.jsxs("label",{className:`flex flex-col items-center justify-center gap-2 border-2 border-dashed border-gray-200 rounded-lg py-6 px-4 text-xs font-medium text-gray-400 cursor-pointer hover:border-espint-blue hover:text-espint-blue transition-all ${s.isUploading?"opacity-50 pointer-events-none":""}`,children:[e.jsx(b,{size:24,className:"opacity-40"}),s.isUploading?"Subiendo...":"Click para subir imagen",e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:U,disabled:s.isUploading})]})]})]}),e.jsxs("div",{className:"mt-8 flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>l(!1),className:"flex-1 px-4 py-2.5 text-gray-600 font-semibold hover:bg-gray-50 rounded-lg transition-colors border border-gray-100",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:!s.name.trim()||c.isPending||s.isUploading,className:"flex-1 px-4 py-2.5 bg-espint-blue text-white font-bold rounded-lg hover:bg-espint-blue-dark transition-all disabled:opacity-50 shadow-md flex items-center justify-center gap-2",children:c.isPending?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"animate-spin",size:18}),"Creando..."]}):"Crear Grupo"})]})]})]})})]})};export{K as default};
