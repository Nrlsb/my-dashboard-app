import{u as y,a as l,j as e,L as j}from"./index-Buzcnw_6.js";import{r as n,c as g,X as N,a2 as w,w as v,y as P,Y as S}from"./ui-libs-DeieS4Kk.js";const A={"/dashboard":"Inicio","/login":"Iniciar Sesión","/new-order":"Nuevo Pedido","/price-list":"Lista de Precios","/products":"Productos","/cart":"Carrito","/orders":"Mis Pedidos","/profile":"Mi Perfil","/admin/dashboard":"Panel Admin","/admin/users":"Gestión Usuarios","/admin/products":"Gestión Productos"},V=({isOpen:i,onClose:c,userId:a,userName:d,isRegularUser:o=!1,isSellerView:x=!1})=>{const[t,h]=n.useState(null),[f,m]=n.useState(!1),p=y();n.useEffect(()=>{i&&a&&u()},[i,a]);const u=async()=>{m(!0);try{let s;x?s=await l.getVendedorClientAnalytics(a):o?s=await l.getUserAnalytics(a):s=await l.getTestUserAnalytics(a),h(s.data)}catch(s){console.error("Error fetching stats:",s)}finally{m(!1)}};if(!i)return null;const b=()=>{let s=`/vendedor-client-analytics/${a}?name=${encodeURIComponent(d)}`;!o&&!x&&(s+="&type=test"),p(s)};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 flex-shrink-0",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(g,{className:"w-5 h-5 text-blue-600"}),"Análisis: ",d]}),e.jsx("button",{onClick:c,className:"text-gray-500 hover:text-gray-700",children:e.jsx(N,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"p-6 overflow-y-auto",children:f?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(j,{text:"Cargando datos..."})}):t?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-700 mb-1",children:[e.jsx(w,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Visitas Totales"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:t.totalVisits})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-700 mb-1",children:[e.jsx(v,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Última Visita"})]}),e.jsx("p",{className:"text-lg font-semibold text-gray-800",children:t.lastVisit?new Date(t.lastVisit).toLocaleDateString():"N/A"}),e.jsx("p",{className:"text-xs text-gray-500",children:t.lastVisit?new Date(t.lastVisit).toLocaleTimeString():""})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3 uppercase tracking-wide",children:"Páginas Más Vistas"}),t.topPages.length>0?e.jsx("ul",{className:"divide-y divide-gray-100",children:t.topPages.map((s,r)=>e.jsxs("li",{className:"py-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600 truncate max-w-[250px]",title:s.path,children:A[s.path]||s.path}),e.jsxs("span",{className:"text-xs font-semibold bg-gray-100 text-gray-600 px-2 py-1 rounded",children:[s.count," visitas"]})]},r))}):e.jsx("p",{className:"text-sm text-gray-500 italic",children:"No hay actividad registrada."})]}),t.downloads&&t.downloads.length>0&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-100",children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-3 uppercase tracking-wide flex items-center gap-2",children:[e.jsx(P,{className:"w-4 h-4"})," Últimas Descargas de Precios"]}),e.jsx("ul",{className:"divide-y divide-gray-100",children:t.downloads.map((s,r)=>e.jsxs("li",{className:"py-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"font-medium text-gray-800",children:new Date(s.created_at).toLocaleDateString()}),e.jsx("span",{className:"text-gray-500 text-xs",children:new Date(s.created_at).toLocaleTimeString()})]}),e.jsxs("div",{className:"text-xs text-gray-600 flex flex-wrap gap-2 items-center bg-gray-50 p-2 rounded",children:[e.jsx(S,{className:"w-3 h-3 text-gray-400"}),s.filters?.searchTerm&&e.jsxs("span",{className:"bg-blue-100 text-blue-800 px-1 rounded",children:["Busq: ",s.filters.searchTerm]}),s.filters?.brands&&s.filters.brands.length>0&&e.jsxs("span",{className:"bg-purple-100 text-purple-800 px-1 rounded cursor-help",title:s.filters.brands.join(", "),children:["Marcas: ",s.filters.brands.length>3?`${s.filters.brands.slice(0,3).join(", ")} y ${s.filters.brands.length-3} más`:s.filters.brands.join(", ")]}),s.filters?.onlyModifiedPrices&&e.jsx("span",{className:"bg-yellow-100 text-yellow-800 px-1 rounded",children:"Solo Modif."}),!s.filters?.searchTerm&&(!s.filters?.brands||s.filters.brands.length===0)&&!s.filters?.onlyModifiedPrices&&e.jsx("span",{className:"italic text-gray-400",children:"Sin filtros"})]})]},r))})]})]}):e.jsx("p",{className:"text-center text-gray-500",children:"No se pudieron cargar los datos."})}),e.jsxs("div",{className:"bg-gray-50 p-4 border-t border-gray-200 flex justify-between items-center",children:[e.jsxs("button",{onClick:b,className:"text-blue-600 hover:text-blue-800 text-sm font-medium flex items-center gap-1",children:["Ver análisis completo ",e.jsx(g,{className:"w-4 h-4"})]}),e.jsx("button",{onClick:c,className:"px-4 py-2 bg-white border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cerrar"})]})]})})};export{V as T};
