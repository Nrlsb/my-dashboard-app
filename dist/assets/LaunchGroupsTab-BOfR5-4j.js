import{u as M,f as D,c as Q,a as n,j as e,L as K}from"./index-B07qn-nV.js";import{r as x,z as i,s as v,$ as w,_ as N,u as $,af as I,X as C,w as O}from"./ui-libs-DRx-SISE.js";import{u as g}from"./useMutation-Dj5b4jhr.js";import"./vendor-qkC6yhPU.js";const X=()=>{const G=M(),d=D(),[U,u]=x.useState(!1),[o,m]=x.useState(null),[s,t]=x.useState({name:"",description:"",image_url:"",isUploading:!1,previewUrl:""}),{data:k,isLoading:z}=Q({queryKey:["adminCarouselGroups"],queryFn:()=>n.getCarouselGroups()}),b=g({mutationFn:r=>n.createCarouselGroup(r),onSuccess:()=>{d.invalidateQueries({queryKey:["adminCarouselGroups"]}),c(),i.success("Grupo creado exitosamente")},onError:r=>{console.error(r),i.error("Error al crear el grupo")}}),h=g({mutationFn:({id:r,data:a})=>n.updateCarouselGroup(r,a),onSuccess:()=>{d.invalidateQueries({queryKey:["adminCarouselGroups"]}),c(),i.success("Grupo actualizado exitosamente")},onError:r=>{console.error(r),i.error("Error al actualizar el grupo")}}),_=g({mutationFn:r=>n.deleteCarouselGroup(r),onSuccess:()=>{d.invalidateQueries({queryKey:["adminCarouselGroups"]}),i.success("Grupo eliminado exitosamente")},onError:r=>{console.error(r),i.error("Error al eliminar el grupo")}}),E=()=>{m(null),t({name:"",description:"",image_url:"",isUploading:!1,previewUrl:""}),u(!0)},S=r=>{m(r),t({name:r.name,description:r.description||"",image_url:r.image_url||"",isUploading:!1,previewUrl:""}),u(!0)},c=()=>{u(!1),m(null),t({name:"",description:"",image_url:"",isUploading:!1,previewUrl:""})},P=r=>{if(r.preventDefault(),!s.name.trim())return;const a={name:s.name,description:s.description,image_url:s.image_url,type:"custom_collection",is_launch_group:!0};o?h.mutate({id:o.id,data:a}):b.mutate(a)},q=r=>{window.confirm("¿Estás seguro de que quieres eliminar este grupo?")&&_.mutate(r)},F=async r=>{const a=r.target.files[0];if(!a)return;const L=URL.createObjectURL(a);t(l=>({...l,isUploading:!0,previewUrl:L}));const j=new FormData;j.append("image",a);try{const l=await n.uploadToDrive(j);t(p=>({...p,image_url:l.imageUrl,isUploading:!1})),i.success("Imagen subida correctamente")}catch(l){console.error(l),i.error("Error al subir imagen"),t(p=>({...p,isUploading:!1}))}};if(z)return e.jsx(K,{});const f=k?.filter(r=>r.is_launch_group===!0)||[],y=b.isPending||h.isPending;return e.jsxs("div",{className:"pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Grupos de Lanzamiento"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Crea y gestiona colecciones de productos para compartir."})]}),e.jsxs("button",{onClick:E,className:"flex items-center gap-2 bg-espint-blue text-white px-4 py-2 rounded-lg hover:bg-espint-blue-dark transition-colors",children:[e.jsx(v,{size:20}),"Crear Grupo"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[f.map(r=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"h-40 bg-gray-100 relative group overflow-hidden",children:[r.image_url?e.jsx("img",{src:r.image_url,alt:r.name,className:"w-full h-full object-cover transition-transform group-hover:scale-105",referrerPolicy:"no-referrer"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:e.jsx(w,{size:40,className:"opacity-20"})}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-2",children:[e.jsx("button",{onClick:()=>S(r),className:"p-2 bg-white/80 backdrop-blur-sm text-gray-500 hover:text-blue-600 rounded-full shadow-sm transition-colors",title:"Editar Grupo",children:e.jsx(N,{size:16})}),e.jsx("button",{onClick:()=>q(r.id),className:"p-2 bg-white/80 backdrop-blur-sm text-gray-400 hover:text-red-500 rounded-full shadow-sm transition-colors",title:"Eliminar Grupo",children:e.jsx($,{size:16})})]})]}),e.jsxs("div",{className:"p-5",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2 truncate",children:r.name}),r.description&&e.jsx("p",{className:"text-sm text-gray-500 line-clamp-2 mb-4 h-10",children:r.description}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("button",{onClick:()=>G(`/admin/launch-groups/${r.id}`),className:"w-full flex items-center justify-center gap-2 bg-espint-blue/10 text-espint-blue py-2 px-4 rounded-lg hover:bg-espint-blue hover:text-white transition-all font-medium text-sm",children:[e.jsx(N,{size:16}),"Gestionar Productos"]}),e.jsxs("button",{onClick:()=>window.open(`/collection/${r.id}`,"_blank"),className:"w-full flex items-center justify-center gap-2 text-gray-500 py-2 px-4 hover:bg-gray-100 rounded-lg transition-colors text-sm",children:[e.jsx(I,{size:16})," Ver Pública"]})]})]})]},r.id)),f.length===0&&e.jsxs("div",{className:"col-span-full py-12 text-center text-gray-400 border-2 border-dashed border-gray-200 rounded-xl bg-white",children:[e.jsx(v,{size:48,className:"mx-auto mb-4 opacity-10"}),e.jsx("p",{children:"No hay grupos creados. Comienza creando uno nuevo."})]})]}),U&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-gray-50/50",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-800",children:o?"Editar Grupo":"Crear Nuevo Grupo"}),e.jsx("button",{onClick:c,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(C,{size:20})})]}),e.jsxs("form",{onSubmit:P,className:"p-6",children:[e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1",children:"Nombre del Grupo *"}),e.jsx("input",{type:"text",required:!0,value:s.name,onChange:r=>t(a=>({...a,name:r.target.value})),className:"w-full border border-gray-200 rounded-lg px-4 py-2 focus:ring-2 focus:ring-espint-blue focus:border-transparent outline-none transition-all",placeholder:"Ej. Colección Verano 2026",autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1",children:"Descripción"}),e.jsx("textarea",{value:s.description,onChange:r=>t(a=>({...a,description:r.target.value})),className:"w-full border border-gray-200 rounded-lg px-4 py-2 focus:ring-2 focus:ring-espint-blue focus:border-transparent outline-none transition-all resize-none",placeholder:"Breve descripción del grupo...",rows:"2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"Imagen de Portada"}),s.previewUrl||s.image_url?e.jsxs("div",{className:"mb-3 relative h-32 rounded-lg bg-gray-50 border border-gray-100 overflow-hidden flex items-center justify-center",children:[e.jsx("img",{src:s.previewUrl||s.image_url,alt:"Preview",className:"max-w-full max-h-full object-contain",referrerPolicy:"no-referrer"}),e.jsx("button",{type:"button",onClick:()=>t(r=>({...r,image_url:"",previewUrl:""})),className:"absolute top-1.5 right-1.5 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 shadow-sm transition-colors",children:e.jsx(C,{size:14})})]}):e.jsxs("label",{className:`flex flex-col items-center justify-center gap-2 border-2 border-dashed border-gray-200 rounded-lg py-6 px-4 text-xs font-medium text-gray-400 cursor-pointer hover:border-espint-blue hover:text-espint-blue transition-all ${s.isUploading?"opacity-50 pointer-events-none":""}`,children:[e.jsx(w,{size:24,className:"opacity-40"}),s.isUploading?"Subiendo...":"Click para subir imagen",e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:F,disabled:s.isUploading})]})]})]}),e.jsxs("div",{className:"mt-8 flex gap-3",children:[e.jsx("button",{type:"button",onClick:c,className:"flex-1 px-4 py-2.5 text-gray-600 font-semibold hover:bg-gray-50 rounded-lg transition-colors border border-gray-100",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:!s.name.trim()||y||s.isUploading,className:"flex-1 px-4 py-2.5 bg-espint-blue text-white font-bold rounded-lg hover:bg-espint-blue-dark transition-all disabled:opacity-50 shadow-md flex items-center justify-center gap-2",children:y?e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"animate-spin",size:18}),o?"Guardando...":"Creando..."]}):o?"Guardar Cambios":"Crear Grupo"})]})]})]})})]})};export{X as default};
