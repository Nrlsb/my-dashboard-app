import{c as M,r as m,u as w,b as P,i as D,e as L,j as e,U as u,M as O,P as S,a as j}from"./index-CUyWuE1j.js";import{u as U}from"./useMutation-DinV0Ypd.js";import{A as N}from"./arrow-left-BQdxlfqP.js";import{T as k}from"./triangle-alert-BPNfIDsm.js";import{C as I}from"./circle-check-big-P3peplgZ.js";import{L as G}from"./loader-circle-Cc97XYkS.js";import{S as R}from"./save-DTHROxzW.js";const B=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],T=M("house",B),n=({icon:s,label:o,id:d,...t})=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:d,className:"block text-sm font-medium text-gray-700 mb-1",children:o}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(s,{className:"w-5 h-5 text-gray-400"})}),e.jsx("input",{id:d,className:"w-full pl-10 p-2.5 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100",...t})]})]}),q=()=>e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"bg-gray-200 h-12 rounded-lg"}),e.jsx("div",{className:"bg-gray-200 h-12 rounded-lg"})]}),e.jsx("div",{className:"bg-gray-200 h-12 rounded-lg"}),e.jsx("div",{className:"bg-gray-200 h-12 rounded-lg"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"bg-gray-200 h-12 rounded-lg"}),e.jsx("div",{className:"bg-gray-200 h-12 rounded-lg"})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx("div",{className:"bg-gray-200 h-10 w-28 rounded-lg"})})]}),z=({message:s})=>e.jsxs("div",{className:"flex flex-col items-center justify-center p-10 bg-white rounded-lg shadow-md",children:[e.jsx("p",{className:"text-red-500 font-semibold text-lg",children:"Error al cargar el perfil"}),e.jsx("p",{className:"text-gray-600 mt-2",children:s})]});function X(){const[s,o]=m.useState({A1_COD:"",A1_LOJA:"",A1_NOME:"",A1_EMAIL:"",A1_NUMBER:"",A1_CGC:"",A1_END:""}),[d,t]=m.useState(""),[x,g]=m.useState(""),h=w(),{user:c}=P(),f=D(),{data:a,isLoading:p,isError:y,error:v,isSuccess:b}=L({queryKey:["userProfile",c?.id],queryFn:()=>j.fetchUserProfile(),enabled:!!c?.id,staleTime:1e3*60*15});m.useEffect(()=>{b&&a&&o({A1_COD:a.A1_COD||"",A1_LOJA:a.A1_LOJA||"",A1_NOME:a.A1_NOME||"",A1_EMAIL:a.A1_EMAIL||"",A1_NUMBER:a.A1_NUMBER||"",A1_CGC:a.A1_CGC||"",A1_END:a.A1_END||""})},[b,a]);const r=U({mutationFn:j.updateUserProfile,onSuccess:i=>{t("¡Perfil actualizado con éxito!"),g(""),f.invalidateQueries({queryKey:["userProfile",c?.id]}),f.invalidateQueries({queryKey:["currentUser"]})},onError:i=>{g(i.message||"Error al guardar los cambios."),t("")}}),l=i=>{const{id:C,value:_}=i.target;o(E=>({...E,[C]:_}))},A=i=>{i.preventDefault(),t(""),g(""),r.mutate(s)};if(p)return e.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[e.jsxs("header",{className:"mb-6 flex items-center",children:[e.jsx("button",{onClick:()=>h("/dashboard"),className:"flex items-center justify-center p-2 mr-4 text-gray-600 bg-white rounded-full shadow-md hover:bg-gray-100 transition-colors","aria-label":"Volver al dashboard",children:e.jsx(N,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Mi Perfil"}),e.jsx("p",{className:"text-gray-600",children:"Actualiza tu información personal y de contacto."})]})]}),e.jsx("div",{className:"bg-white p-8 rounded-lg shadow-md max-w-4xl mx-auto",children:e.jsx(q,{})})]});if(y){const i=c?.id?v.message:"No se ha podido identificar al usuario.";return e.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[e.jsx("header",{className:"mb-6",children:e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Mi Perfil"})}),e.jsx(z,{message:i})]})}return e.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[e.jsxs("header",{className:"mb-6 flex items-center",children:[e.jsx("button",{onClick:()=>h("/dashboard"),className:"flex items-center justify-center p-2 mr-4 text-gray-600 bg-white rounded-full shadow-md hover:bg-gray-100 transition-colors","aria-label":"Volver al dashboard",children:e.jsx(N,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Mi Perfil"}),e.jsx("p",{className:"text-gray-600",children:"Actualiza tu información personal y de contacto."})]})]}),e.jsx("div",{className:"bg-white p-8 rounded-lg shadow-md max-w-4xl mx-auto",children:e.jsxs("form",{onSubmit:A,className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:e.jsx(n,{icon:u,label:"Código de Cliente",id:"A1_COD",value:s.A1_COD,onChange:l,disabled:!0})}),e.jsx(n,{icon:u,label:"Nombre / Razón Social",id:"A1_NOME",value:s.A1_NOME,onChange:l,disabled:r.isPending}),e.jsx(n,{icon:u,label:"CUIT",id:"A1_CGC",value:s.A1_CGC,onChange:l,disabled:r.isPending}),e.jsx(n,{icon:T,label:"Dirección",id:"A1_END",value:s.A1_END,onChange:l,disabled:r.isPending}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(n,{icon:O,label:"Email de Contacto",id:"A1_EMAIL",type:"email",value:s.A1_EMAIL,onChange:l,disabled:r.isPending}),e.jsx(n,{icon:S,label:"Teléfono",id:"A1_NUMBER",type:"tel",value:s.A1_NUMBER,onChange:l,disabled:r.isPending})]}),x&&e.jsxs("div",{className:"flex items-center p-3 bg-red-100 text-red-700 rounded-md",children:[e.jsx(k,{className:"w-5 h-5 mr-2 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:x})]}),d&&e.jsxs("div",{className:"flex items-center p-3 bg-green-100 text-green-700 rounded-md",children:[e.jsx(I,{className:"w-5 h-5 mr-2 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:d})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-200",children:e.jsxs("button",{type:"submit",className:"inline-flex items-center justify-center px-6 py-2.5 bg-blue-600 text-white font-medium rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors disabled:opacity-50",disabled:r.isPending,children:[r.isPending?e.jsx(G,{className:"w-5 h-5 mr-2 animate-spin"}):e.jsx(R,{className:"w-5 h-5 mr-2"}),r.isPending?"Guardando...":"Guardar Cambios"]})})]})})]})}export{X as default};
